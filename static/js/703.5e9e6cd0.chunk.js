"use strict";(self.webpackChunksinag_project=self.webpackChunksinag_project||[]).push([[703],{2703:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var n=a(885),r=a(2791),o=a(9513),c=a.n(o),i=(a(8639),a(6355)),l=a(429),s=a(4819),u=a(184);s.kL.register(s.f$,s.uw,s.ZL,s.od,s.jn,s.De,s.u,s.Gu,s.ST,s.vn,l.ZP);s.kL.register(s.uw,s.f$,s.ZL,s.Dx,s.u,s.De,l.ZP);var d=a(2982),p=a(3623);s.kL.register(s.f$,s.uw,s.ZL,s.od,s.jn,s.De,s.u,s.Gu,s.ST,s.vn,l.ZP);var m=function(e){var t=e.data,a=e.viewMode,o=(0,r.useState)([]),c=(0,n.Z)(o,2),i=c[0],l=c[1],s=(0,r.useState)([]),m=(0,n.Z)(s,2),y=m[0],b=m[1],f=(0,r.useState)([]),v=(0,n.Z)(f,2),h=v[0],g=v[1],x=(0,r.useState)([]),Z=(0,n.Z)(x,2),k=Z[0],w=Z[1],j=(0,r.useState)([]),L=(0,n.Z)(j,2),C=L[0],D=L[1],S=(0,r.useState)([]),M=(0,n.Z)(S,2),_=M[0],N=M[1];(0,r.useEffect)((function(){try{switch(l([]),b([]),g([]),w([]),D([]),N([]),a){case"day":t.map((function(e){b((function(t){return[].concat((0,d.Z)(t),[e.batt_level])})),l((function(t){return[].concat((0,d.Z)(t),[e.time])})),g((function(t){return[].concat((0,d.Z)(t),[e.led_status])})),w((function(t){return[].concat((0,d.Z)(t),[e.charging])}))}));break;case"month":t.reduce((function(e,t){var a=e.find((function(e){return e.date===t.date}));return a?(a.maxLevel=Math.max(a.maxLevel,parseFloat(t.batt_level)),a.minLevel=Math.min(a.minLevel,parseFloat(t.batt_level))):e.push({date:t.date,maxLevel:parseFloat(t.batt_level),minLevel:parseFloat(t.batt_level)}),e}),[]).map((function(e){D((function(t){return[].concat((0,d.Z)(t),[e.maxLevel])})),N((function(t){return[].concat((0,d.Z)(t),[e.minLevel])})),l((function(t){return[].concat((0,d.Z)(t),[e.date])}))}));break;case"year":for(var e=["January","February","March","April","May","June","July","August","September","October","November","December"],r={},o={},c={},i={},s=0;s<t.length;s++){var u=t[s].date.split(" "),p=e.indexOf(u[0]),m=u[2],y="".concat(e[p],"-").concat(m),f=parseInt(u[1]),v=parseFloat(t[s].batt_level);r[y]||(r[y]={},o[y]={},c[y]={},i[y]={}),r[y][f]||(r[y][f]=[],o[y][f]=0,c[y][f]=0,i[y][f]=0),r[y][f].push(v),o[y][f]++,c[y][f]+=v,i[y][f]+=v}var h=[];for(var x in r){var Z=x.split("-"),k=(0,n.Z)(Z,2),j=k[0],L=(k[1],e.indexOf(j)+1),C=[],S=[];for(var M in r[x]){var _=Math.max.apply(Math,(0,d.Z)(r[x][M])),A=Math.min.apply(Math,(0,d.Z)(r[x][M]));C.push(_),S.push(A)}var P=C.reduce((function(e,t){return e+t}),0)/C.length,F=S.reduce((function(e,t){return e+t}),0)/S.length;h.push({month:e[L-1],averageMaxLevel:P,averageMinLevel:F})}h.map((function(e){D((function(t){return[].concat((0,d.Z)(t),[e.averageMaxLevel])})),N((function(t){return[].concat((0,d.Z)(t),[e.averageMinLevel])})),l((function(t){return[].concat((0,d.Z)(t),[e.month])}))}));break;default:return}}catch(I){}}),[t,a]);var A={responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},scales:"day"!==a?{x:{stacked:!0},y:{min:0,max:100}}:{x:{type:"category",ticks:{maxRotation:0,autoSkipPadding:50}},y2:{type:"linear",position:"left",min:0,max:100},y1:{type:"linear",offset:!0,position:"right",min:0,max:1,ticks:{stepSize:1}}},plugins:{legend:{position:"bottom",display:!0,labels:{filter:function(e,t){return"day"===a||"Lamp"!==e.text&&"Charging"!==e.text}}},title:{display:!0,text:"day"===a?"Battery Level, Charging & LED Status":"month"===a?"Battery Level":"Average Battery Level",font:{size:24}},zoom:{pan:{enabled:!0,mode:"x"},zoom:{pinch:{enabled:!0},wheel:{enabled:!0},mode:"x"}},clip:{left:25,right:25}}},P={labels:i,datasets:"day"!==a?[{type:"bar",label:"Maximum",data:C,backgroundColor:"rgba(9, 15, 30, 0.5)",borderColor:"rgba(9, 15, 30, 1)",yAxisID:"y"},{type:"bar",label:"Minimum",data:_,backgroundColor:"rgba(28, 164, 63, 1)",borderColor:"rgba(28, 164, 63, 1)",yAxisID:"y"}]:[{type:"line",label:"Lamp",data:h,backgroundColor:"rgb(243, 156, 18, 0.8)",borderColor:"rgb(243, 156, 18, 0.8)",yAxisID:"y1",stepped:!0,order:1},{type:"line",label:"Charging",data:k,backgroundColor:"rgba(28, 164, 63, 0.8)",borderColor:"rgba(28, 164, 63, 0.8)",yAxisID:"y1",stepped:!0,order:1},{type:"day"===a?"line":"bar",label:"Level (%)",data:y,backgroundColor:"rgba(9, 15, 30, 0.8)",borderColor:"rgba(9, 15, 30, 0.8)",yAxisID:"y2",order:2,fill:!0}]};return(0,u.jsx)(p.kL,{options:A,data:P})};s.kL.register(s.f$,s.uw,s.ZL,s.od,s.jn,s.De,s.u,s.Gu,s.ST,s.vn,l.ZP);var y=function(e){var t=e.data,a=e.viewMode,o=(0,r.useState)([]),c=(0,n.Z)(o,2),i=c[0],l=c[1],s=(0,r.useState)([]),m=(0,n.Z)(s,2),y=m[0],b=m[1],f=(0,r.useState)([]),v=(0,n.Z)(f,2),h=v[0],g=v[1],x=(0,r.useState)([]),Z=(0,n.Z)(x,2),k=Z[0],w=Z[1];(0,r.useEffect)((function(){try{switch(l([]),b([]),g([]),w([]),a){case"all":var e=Array.from(new Set(t.map((function(e){return e.time}))));e.sort((function(e,t){var a=new Date("1970-01-01T".concat(e)),n=new Date("1970-01-01T".concat(t));return a.getTime()-n.getTime()})),e.forEach((function(e){var a=t.find((function(t){return t.time===e}));a&&(l((function(t){return[].concat((0,d.Z)(t),[e])})),b((function(e){return[].concat((0,d.Z)(e),[a.pv_power])})),g((function(e){return[].concat((0,d.Z)(e),[a.temp])})),w((function(e){return[].concat((0,d.Z)(e),[a.lux])})))}));break;case"day":t.map((function(e){l((function(t){return[].concat((0,d.Z)(t),[e.time])})),b((function(t){return[].concat((0,d.Z)(t),[e.pv_power])})),g((function(t){return[].concat((0,d.Z)(t),[e.temp])})),w((function(t){return[].concat((0,d.Z)(t),[e.lux])}))}));break;case"month":t.reduce((function(e,t){var a=e.find((function(e){return e.date===t.date}));return a?(a.sys_power+=.08333*parseFloat(t.pv_power),a.sys_temp+=parseFloat(t.temp),a.sys_lux+=parseFloat(t.lux),a.count+=1):e.push({date:t.date,sys_power:.08333*t.pv_power,sys_temp:t.temp,sys_lux:t.lux,count:1}),e}),[]).map((function(e){l((function(t){return[].concat((0,d.Z)(t),[e.date])})),b((function(t){return[].concat((0,d.Z)(t),[e.sys_power])})),g((function(t){return[].concat((0,d.Z)(t),[e.sys_temp/e.count])})),w((function(t){return[].concat((0,d.Z)(t),[e.sys_lux/e.count])}))}));break;case"year":for(var r=["January","February","March","April","May","June","July","August","September","October","November","December"],o={},c={},i={},s={},u=0;u<t.length;u++){var p=t[u].date.split(" "),m=r.indexOf(p[0]),y=p[2],f="".concat(r[m],"-").concat(y),v=t[u].pv_power,h=t[u].temp,x=t[u].lux;o[f]?(o[f]+=v,c[f]+=h,i[f]+=x,s[f]++):(o[f]=v,c[f]=h,i[f]=x,s[f]=1)}var Z=[];for(var k in o){var j=k.split("-"),L=(0,n.Z)(j,2),C=L[0],D=(L[1],r.indexOf(C)+1),S=.08333*o[k],M=c[k]/s[k],_=i[k]/s[k];Z.push({month:r[D-1],generate:S,temp:M,lux:_})}Z.map((function(e){b((function(t){return[].concat((0,d.Z)(t),[e.generate])})),g((function(t){return[].concat((0,d.Z)(t),[e.temp])})),w((function(t){return[].concat((0,d.Z)(t),[e.lux])})),l((function(t){return[].concat((0,d.Z)(t),[e.month])}))}));break;default:return}}catch(N){}}),[t,a]);var j={responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},plugins:{legend:{position:"bottom"},title:{display:!0,text:"day"===a?"Solar PV Panel Output":"Average Solar PV Panel Output",font:{size:24}},zoom:{pan:{enabled:!0,mode:"x"},zoom:{pinch:{enabled:!0},wheel:{enabled:!0},mode:"x"}}},scales:{x:{type:"category",ticks:{maxRotation:0,autoSkipPadding:50}},y:{type:"linear",position:"right"},y1:{type:"linear",position:"left"}}},L={labels:i,datasets:[{type:"all"===a?"scatter":"line",label:"Temperature (\xb0C)",backgroundColor:"rgb(4, 59, 92, 1)",data:"all"===a?t.map((function(e){return{x:e.time,y:e.temp}})):h,borderColor:"rgb(4, 59, 92, 1)",yAxisID:"y1"},{type:"all"===a?"scatter":"line",label:"Ambient Light (lux)",backgroundColor:"rgb(22, 160, 133, 1)",data:"all"===a?t.map((function(e){return{x:e.time,y:e.lux}})):k,borderColor:"rgb(22, 160, 133, 1)",yAxisID:"y"},{type:"all"===a?"scatter":"day"===a?"line":"bar",label:"day"===a?"Power (W)":"Energy (Wh)",data:"all"===a?t.map((function(e){return{x:e.time,y:e.pv_power}})):y,backgroundColor:"rgb(207, 0, 15, 1)",borderColor:"rgb(207, 0, 15, 1)",yAxisID:"y1"}]};return(0,u.jsx)(p.kL,{options:j,data:L})};function b(e){var t=(0,r.useState)(new Date),a=(0,n.Z)(t,2),o=a[0],l=a[1],s=(0,r.useState)(!1),d=(0,n.Z)(s,2),p=d[0],b=d[1],f=new Date(2023,4,28),v=(0,r.useState)("day"),h=(0,n.Z)(v,2),g=h[0],x=h[1],Z=(0,r.useState)({month:"long",day:"numeric",year:"numeric"}),k=(0,n.Z)(Z,2),w=k[0],j=k[1],L=function(e){e.value;var t=e.onClick;return(0,u.jsx)(i.IiJ,{className:"date-picker-icon",onClick:t})},C=function(e){x(e),j("month"===e?{month:"long",year:"numeric"}:"year"===e?{year:"numeric"}:{month:"long",day:"numeric",year:"numeric"})},D=w,S=o.toLocaleDateString("en-US",D),M=e.data,_=M.filter((function(e){var t=new Date(e.date),a=t.getMonth(),n=t.getDate(),r=t.getFullYear(),o=new Date(S),c=o.getMonth(),i=o.getDate(),l=o.getFullYear();switch(g){case"day":default:return a===c&&n===i&&r===l;case"month":return a===c&&r===l;case"year":return r===l}}));return(0,u.jsxs)("div",{className:"analysis-container",children:[(0,u.jsx)("div",{className:"d-flex align-items-center my-0",children:(0,u.jsx)("h3",{className:"my-0",children:"System Analysis"})}),(0,u.jsxs)("div",{className:"date-view-wrapper d-flex align-items-center",children:[(0,u.jsx)("div",{className:"analysis-date-picker w-50 py-1",children:(0,u.jsxs)("div",{className:"date-picker-container d-flex justify-content-start align-items-center gap-2",children:[(0,u.jsx)(L,{onClick:function(){b(!p)}}),(0,u.jsx)("h6",{className:"my-0",children:S})]})}),"     ",(0,u.jsxs)("div",{className:"analysis-date-type w-100 d-flex justify-content-end gap-2",children:[(0,u.jsx)("button",{className:"day"===g?"btn date-type-btn-active btn date-type-btn":"btn date-type-btn",onClick:function(){return C("day")},children:"Day"}),(0,u.jsx)("button",{className:"month"===g?"btn date-type-btn-active btn date-type-btn":"btn date-type-btn",onClick:function(){return C("month")},children:"Month"}),(0,u.jsx)("button",{className:"year"===g?"btn date-type-btn-active btn date-type-btn":"btn date-type-btn",onClick:function(){return C("year")},children:"Year"}),(0,u.jsx)("button",{className:"all"===g?"btn date-type-btn-active btn date-type-btn":"btn date-type-btn",onClick:function(){return C("all")},children:"All"})]})]}),p&&(0,u.jsx)("div",{className:"calendar-container",children:(0,u.jsx)(c(),{selected:o,onChange:function(e){l(e),b(!1)},showMonthYearPicker:"month"===g,showYearPicker:"year"===g,customInput:(0,u.jsx)(u.Fragment,{}),popperPlacement:"top-start",inline:!0,minDate:f,maxDate:new Date})}),(0,u.jsxs)("div",{className:"analysis-section mt-3",children:[(0,u.jsx)("div",{className:"chart mb-4",children:(0,u.jsx)(y,{data:"all"===g?M:_,viewMode:g,className:"chart"})}),(0,u.jsx)("div",{className:"chart",children:(0,u.jsx)(m,{data:_,viewMode:g,className:"chart"})})]})]})}var f=(0,r.memo)(b)}}]);
//# sourceMappingURL=703.5e9e6cd0.chunk.js.map