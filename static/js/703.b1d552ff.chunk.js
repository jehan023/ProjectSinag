"use strict";(self.webpackChunksinag_project=self.webpackChunksinag_project||[]).push([[703],{2703:function(e,t,n){n.r(t),n.d(t,{default:function(){return y}});var a=n(885),r=n(2791),c=n(9513),o=n.n(c),u=(n(8639),n(6355)),s=n(2982),i=n(429),l=n(1948),d=n(3623),p=n(184);l.kL.register(l.uw,l.f$,l.ZL,l.Dx,l.u,l.De,i.ZP);var f=function(e){var t=e.data,n=e.viewMode,c=(0,r.useState)([]),o=(0,a.Z)(c,2),u=o[0],i=o[1],l=(0,r.useState)([]),f=(0,a.Z)(l,2),m=f[0],b=f[1],v=(0,r.useState)([]),y=(0,a.Z)(v,2),h=(y[0],y[1]);(0,r.useEffect)((function(){try{switch(i([]),b([]),n){case"day":t.map((function(e){b((function(t){return[].concat((0,s.Z)(t),[e.pv_power])})),h((function(t){return[].concat((0,s.Z)(t),[e.pv_power])})),i((function(t){return[].concat((0,s.Z)(t),[e.time])}))}));break;case"month":t.reduce((function(e,t){var n=e.find((function(e){return e.date===t.date}));return n?n.pv_gen+=.16667*parseFloat(t.pv_power):e.push({date:t.date,pv_gen:.16667*t.pv_power}),e}),[]).map((function(e){b((function(t){return[].concat((0,s.Z)(t),[e.pv_gen])})),i((function(t){return[].concat((0,s.Z)(t),[e.date])}))}));break;case"year":for(var e=["January","February","March","April","May","June","July","August","September","October","November","December"],r={},c=0;c<t.length;c++){var o=t[c].date.split(" "),u=e.indexOf(o[0]),l=o[2],d="".concat(e[u],"-").concat(l),p=t[c].pv_power;r[d]?r[d]+=p:r[d]=p}var f={};for(var m in r){var v=m,y=r[m];f[v]?f[v]+=y:f[v]=y}var g=[];for(var x in f){var Z=x.split("-"),k=(0,a.Z)(Z,2),w=k[0],j=(k[1],e.indexOf(w)+1),_=f[x];g.push({month:e[j-1],sum:_})}g.map((function(e){b((function(t){return[].concat((0,s.Z)(t),[e.sum])})),h((function(t){return[].concat((0,s.Z)(t),[e.sum])})),i((function(t){return[].concat((0,s.Z)(t),[e.month])}))}));break;default:return}}catch(N){}}),[t,n]);var g={labels:u,datasets:[{label:"Generate (Wh)",data:m,backgroundColor:"rgba(255, 99, 132, 1)"}]};return(0,p.jsx)(d.$Q,{options:{responsive:!0,plugins:{legend:{position:"bottom"},title:{display:!0,text:"Energy (Wh)",font:{size:24}},zoom:{pan:{enabled:!0,mode:"x"}}}},data:g})};l.kL.register(l.uw,l.f$,l.ZL,l.Dx,l.u,l.De,i.ZP);l.kL.register(l.f$,l.uw,l.ZL,l.od,l.jn,l.De,l.u,l.Gu,l.ST,l.vn,i.ZP);var m=function(e){var t=e.data,n=e.viewMode,c=(0,r.useState)([]),o=(0,a.Z)(c,2),u=o[0],i=o[1],l=(0,r.useState)([]),f=(0,a.Z)(l,2),m=f[0],b=f[1],v=(0,r.useState)([]),y=(0,a.Z)(v,2),h=y[0],g=y[1],x=(0,r.useState)([]),Z=(0,a.Z)(x,2),k=Z[0],w=Z[1];(0,r.useEffect)((function(){try{switch(i([]),b([]),g([]),w([]),n){case"day":t.map((function(e){b((function(t){return[].concat((0,s.Z)(t),[e.batt_level])})),i((function(t){return[].concat((0,s.Z)(t),[e.time])})),g((function(t){return[].concat((0,s.Z)(t),[e.led_status])})),w((function(t){return[].concat((0,s.Z)(t),[e.charging])}))}));break;case"month":t.reduce((function(e,t){var n=e.find((function(e){return e.date===t.date}));return n?n.level=Math.max(n.level,parseFloat(t.batt_level)):e.push({date:t.date,level:t.batt_level}),e}),[]).map((function(e){b((function(t){return[].concat((0,s.Z)(t),[e.level])})),i((function(t){return[].concat((0,s.Z)(t),[e.date])}))}));break;case"year":for(var e=["January","February","March","April","May","June","July","August","September","October","November","December"],r={},c={},o=0;o<t.length;o++){var u=t[o].date.split(" "),l=e.indexOf(u[0]),d=u[2],p="".concat(e[l],"-").concat(d),f=t[o].batt_level;r[p]?(r[p]+=f,c[p]++):(r[p]=f,c[p]=1)}var m=[];for(var v in r){var y=v.split("-"),h=(0,a.Z)(y,2),x=h[0],Z=(h[1],e.indexOf(x)+1),k=r[v]/c[v];m.push({month:e[Z-1],level:k})}m.map((function(e){b((function(t){return[].concat((0,s.Z)(t),[e.level])})),i((function(t){return[].concat((0,s.Z)(t),[e.month])}))}));break;default:return}}catch(j){}}),[t,n]);var j={labels:u,datasets:[{type:"bar",label:"Level (%)",data:m,backgroundColor:function(e){return k[e.dataIndex]?"rgba(28, 164, 63, 0.8)":h[e.dataIndex]?"rgb(207, 0, 15, 0.8)":"rgba(75,192,192,0.8)"}},{type:"line",label:"Lamp ON",backgroundColor:"rgb(207, 0, 15, 0.8)"},{type:"line",label:"Charging",backgroundColor:"rgba(28, 164, 63, 0.8)"}]};return(0,p.jsx)(d.kL,{options:{responsive:!0,plugins:{legend:{position:"bottom",labels:{filter:function(e,t){return 0!==e.datasetIndex}}},title:{display:!0,text:"Battery Level",font:{size:24}},zoom:{pan:{enabled:!0,mode:"x"}}}},data:j})};l.kL.register(l.f$,l.uw,l.ZL,l.od,l.jn,l.De,l.u,l.Gu,l.ST,l.vn,i.ZP);var b=function(e){var t=e.data,n=e.viewMode,c=(0,r.useState)([]),o=(0,a.Z)(c,2),u=o[0],i=o[1],l=(0,r.useState)([]),f=(0,a.Z)(l,2),m=f[0],b=f[1],v=(0,r.useState)([]),y=(0,a.Z)(v,2),h=y[0],g=y[1],x=(0,r.useState)([]),Z=(0,a.Z)(x,2),k=Z[0],w=Z[1];(0,r.useEffect)((function(){try{switch(i([]),b([]),g([]),w([]),n){case"day":t.map((function(e){i((function(t){return[].concat((0,s.Z)(t),[e.time])})),b((function(t){return[].concat((0,s.Z)(t),[e.pv_power])})),g((function(t){return[].concat((0,s.Z)(t),[e.temp])})),w((function(t){return[].concat((0,s.Z)(t),[e.lux])}))}));break;case"month":var e=t.reduce((function(e,t){var n=e.find((function(e){return e.date===t.date}));return n?(n.sys_power+=.16667*parseFloat(t.pv_power),n.sys_temp+=parseFloat(t.temp),n.sys_lux+=parseFloat(t.lux),n.count+=1):e.push({date:t.date,sys_power:.16667*t.pv_power,sys_temp:t.temp,sys_lux:t.lux,count:1}),e}),[]);e.map((function(e){i((function(t){return[].concat((0,s.Z)(t),[e.date])})),b((function(t){return[].concat((0,s.Z)(t),[e.sys_power])})),g((function(t){return[].concat((0,s.Z)(t),[e.sys_temp/e.count])})),w((function(t){return[].concat((0,s.Z)(t),[e.sys_lux/e.count])}))})),console.table(e);break;case"year":for(var r=["January","February","March","April","May","June","July","August","September","October","November","December"],c={},o={},u={},l={},d=0;d<t.length;d++){var p=t[d].date.split(" "),f=r.indexOf(p[0]),m=p[2],v="".concat(r[f],"-").concat(m),y=t[d].pv_power,h=t[d].temp,x=t[d].lux;c[v]?(c[v]+=y,o[v]+=h,u[v]+=x,l[v]++):(c[v]=y,o[v]=h,u[v]=x,l[v]=1)}var Z=[];for(var k in c){var j=k.split("-"),_=(0,a.Z)(j,2),N=_[0],S=(_[1],r.indexOf(N)+1),C=c[k]/l[k],D=o[k]/l[k],M=u[k]/l[k];Z.push({month:r[S-1],generate:C,temp:D,lux:M})}Z.map((function(e){b((function(t){return[].concat((0,s.Z)(t),[e.generate])})),g((function(t){return[].concat((0,s.Z)(t),[e.temp])})),w((function(t){return[].concat((0,s.Z)(t),[e.lux])})),i((function(t){return[].concat((0,s.Z)(t),[e.month])}))}));break;default:return}}catch(L){}}),[t,n]);var j={labels:u,datasets:[{type:"line",label:"Temperature (\xb0C)",backgroundColor:"rgb(4, 59, 92, 1)",data:h,borderColor:"rgb(4, 59, 92, 1)"},{type:"line",label:"Ambient Light (Lux)",backgroundColor:"rgb(22, 160, 133, 1)",data:k,borderColor:"rgb(22, 160, 133, 1)"},{type:"line",label:"Generation (Wh)",data:m,backgroundColor:"rgb(207, 0, 15, 1)",borderColor:"rgb(207, 0, 15, 1)"}]};return(0,p.jsx)(d.kL,{options:{responsive:!0,plugins:{legend:{position:"bottom"},title:{display:!0,text:"Energy Production",font:{size:24}},zoom:{pan:{enabled:!0,mode:"x"}}}},data:j})};function v(e){var t=(0,r.useState)(new Date),n=(0,a.Z)(t,2),c=n[0],s=n[1],i=(0,r.useState)(!1),l=(0,a.Z)(i,2),d=l[0],v=l[1],y=new Date(2022,10,1),h=(0,r.useState)("day"),g=(0,a.Z)(h,2),x=g[0],Z=g[1],k=(0,r.useState)({month:"long",day:"numeric",year:"numeric"}),w=(0,a.Z)(k,2),j=w[0],_=w[1],N=function(e){e.value;var t=e.onClick;return(0,p.jsx)(u.IiJ,{className:"date-picker-icon",onClick:t})},S=function(e){Z(e),_("month"===e?{month:"long",year:"numeric"}:"year"===e?{year:"numeric"}:{month:"long",day:"numeric",year:"numeric"})},C=j,D=c.toLocaleDateString("en-US",C),M=e.data.filter((function(e){var t=new Date(e.date),n=t.getMonth(),a=t.getDate(),r=t.getFullYear(),c=new Date(D),o=c.getMonth(),u=c.getDate(),s=c.getFullYear();switch(x){case"day":default:return n===o&&a===u&&r===s;case"month":return n===o&&r===s;case"year":return r===s}}));return(0,p.jsxs)("div",{className:"analysis-container",children:[(0,p.jsx)("div",{className:"d-flex align-items-center my-0",children:(0,p.jsx)("h3",{className:"my-0",children:"System Analysis"})}),(0,p.jsxs)("div",{className:"d-flex align-items-center",children:[(0,p.jsx)("div",{className:"analysis-date-picker w-50 py-1",children:(0,p.jsxs)("div",{className:"date-picker-container d-flex justify-content-start align-items-center gap-2",children:[(0,p.jsx)(N,{onClick:function(){v(!d)}}),(0,p.jsx)("h6",{className:"my-0",children:D})]})}),"     ",(0,p.jsxs)("div",{className:"analysis-date-type w-100 d-flex justify-content-end gap-2",children:[(0,p.jsx)("button",{className:"day"===x?"btn date-type-btn-active btn date-type-btn":"btn date-type-btn",onClick:function(){return S("day")},children:"Day"}),(0,p.jsx)("button",{className:"month"===x?"btn date-type-btn-active btn date-type-btn":"btn date-type-btn",onClick:function(){return S("month")},children:"Month"}),(0,p.jsx)("button",{className:"year"===x?"btn date-type-btn-active btn date-type-btn":"btn date-type-btn",onClick:function(){return S("year")},children:"Year"})]})]}),d&&(0,p.jsx)("div",{className:"calendar-container",children:(0,p.jsx)(o(),{selected:c,onChange:function(e){s(e),v(!1)},showMonthYearPicker:"month"===x,showYearPicker:"year"===x,customInput:(0,p.jsx)(p.Fragment,{}),popperPlacement:"top-start",inline:!0,minDate:y,maxDate:new Date})}),(0,p.jsxs)("div",{className:"analysis-section mt-3",children:[(0,p.jsx)("div",{className:"chart energy-chart mb-4",children:(0,p.jsx)(f,{data:M,viewMode:x})}),(0,p.jsx)("div",{className:"chart mb-4",children:(0,p.jsx)(b,{data:M,viewMode:x,className:"chart"})}),(0,p.jsx)("div",{className:"chart",children:(0,p.jsx)(m,{data:M,viewMode:x,className:"chart"})})]})]})}var y=(0,r.memo)(v)}}]);
//# sourceMappingURL=703.b1d552ff.chunk.js.map